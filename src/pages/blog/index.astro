---
import { getCollection } from 'astro:content';
import Layout from '@layouts/layout.astro';
import { readingTimeKey } from '@utils/remark-reading-time';

const posts = await getCollection('blog');
const filteredPosts = posts.filter((post) => import.meta.env.DEV || !post.data.draft);
---

<Layout title="Blog">
	<h2 class="leading-tight font-bold text-4xl mt-8 mb-12 text-gradient">My blog posts</h2>
	<div class="space-y-12">
		{
			filteredPosts.map(({ data: post, id: slug, rendered }) => {
				const readingTime = (rendered?.metadata?.frontmatter as any)[readingTimeKey];
				return (
					<article>
						<a
							href={`/blog/${slug}`}
							class="block group space-y-4 outline-0 focus-visible:shadow-[0px_0px_0px_2px_rgb(var(--color-primary-400))]"
						>
							<h2 class="font-bold text-2xl group-hover:text-primary-400 motion-safe:transition-colors">{post.title}</h2>
							<p class="text-gray-500">
								{post.date.formatted} - {readingTime}
							</p>
							<p>{post.description}</p>
							<div class='font-bold after:content-["_â†’"] after:opacity-0 group-hover:after:opacity-100 motion-safe:after:transition-opacity'>
								Read more
							</div>
						</a>
					</article>
				);
			})
		}
	</div>
</Layout>
